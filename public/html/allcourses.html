<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>All Courses</title>

    <!-- Font Awesome CDN link -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css">

    <!-- Custom CSS file link -->
    <link rel="stylesheet" href="/css/style.css"> <!-- Adjusted path for stylesheet -->
</head>
<body>

<!-- Header Section -->
<header class="header">
    <section class="flex">
        <div id="menu-btn" class="fas fa-bars"></div>
        <a href="/html/home.html" class="logo">ITB Virtual Lab</a>

        <form action="" method="post" class="search-form" onsubmit="searchCourses(event)">
            <input type="text" id="searchBox" placeholder="Cari Mata Kuliah..." maxlength="100">
            <button type="submit" class="fas fa-search"></button>
        </form> 

        <div class="icons">
            <div id="user-btn" class="fas fa-user"></div>
            <div id="toggle-btn" class="fas fa-sun"></div>
        </div>

        <div class="profile">
            <img id="headerProfileImage" src="/images/pic-1.png" alt="Profile Picture">
            <h3 id="headerUserName">User Name</h3>
            <span id="headerUserRole">Student</span>
            <a href="/html/profile.html" class="btn">View Profile</a>
            <div class="flex-btn">
                <a href="/html/login.html" class="option-btn">Logout</a>
            </div>
        </div>
    </section>
</header>

<!-- Sidebar Section -->
<div class="side-bar">
    <div id="close-btn">
        <i class="fas fa-times"></i>
    </div>

    <div class="profile">
        <img id="sidebarProfileImage" src="/images/pic-1.png" class="image" alt="Profile Picture">
        <h3 id="sidebarUserName" class="name">User Name</h3>
        <p id="sidebarUserRole" class="role">Student</p>
    </div>

    <nav class="navbar">
        <a href="/html/home.html"><i class="fas fa-home"></i><span>Home</span></a>
        <a href="/html/courses.html"><i class="fas fa-graduation-cap"></i><span>My Courses</span></a>
        <a href="/html/exam.html"><i class="fas fa-clipboard-check"></i><span>Exam</span></a>
        <a href="/html/practicum.html"><i class="fas fa-flask"></i><span>Practicum</span></a>
    </nav>
</div>

<!-- Courses Section -->
<section class="courses">
    <h1 class="heading">All TPB Courses</h1>
    <div class="box-container">
        <!-- Sample Courses -->
        <div class="box">
            <div class="sub-course">
                <img src="/images/user.png" alt="Lecturer">
                <div class="info">
                    <h3>Siti</h3>
                    <span>Pancasila Lecturer</span>
                </div>
            </div>
            <div class="thumb">
                <img src="/images/pancasila.png" alt="Pancasila Course">
                <span>10 Modules</span>
            </div>
            <h3 class="title">KU1231 Pancasila</h3>
            <a href="#" class="inline-btn" onclick="showDevelopmentNotification()">View Course</a>
            <a href="#" class="inline-enroll-btn" onclick="showDevelopmentNotification()">Enroll This Course</a>
        </div>

        <div class="box">
            <div class="sub-course">
                <img src="/images/user.png" alt="Lecturer">
                <div class="info">
                    <h3>Ayi</h3>
                    <span>English Lecturer</span>
                </div>
            </div>
            <div class="thumb">
                <img src="/images/english.png" alt="English Course">
                <span>15 Modules</span>
            </div>
            <h3 class="title">KU1232 English</h3>
            <a href="#" class="inline-btn" onclick="showDevelopmentNotification()">View Course</a>
            <a href="#" class="inline-enroll-btn" onclick="showDevelopmentNotification()">Enroll This Course</a>
        </div>

        <div class="box">
            <div class="sub-course">
                <img src="/images/user.png" alt="">
                <div class="info">
                    <h3>Ayi</h3>
                    <span>English Lecturer</span>
                </div>
            </div>
            <div class="thumb">
                <img src="/images/english.png" alt="">
                <span>15 modules</span>
            </div>
            <h3 class="title">KU1232 English</h3>
            <a href="#" class="inline-btn" onclick="showDevelopmentNotification()">view Course</a>
            <a href="#" class="inline-enroll-btn" onclick="showDevelopmentNotification()">Enroll This Course</a>
        </div>
    
        <div class="box">
            <div class="sub-course">
                <img src="/images/user.png" alt="">
                <div class="info">
                    <h3>Yakub</h3>
                    <span>Design Engineering Lecturer</span>
                </div>
            </div>
            <div class="thumb">
                <img src="/images/design engineering.png" alt="">
                <span>12 modules</span>
            </div>
            <h3 class="title">KU1233 Design Engineering</h3>
            <a href="#" class="inline-btn" onclick="showDevelopmentNotification()">view Course</a>
            <a href="#" class="inline-enroll-btn" onclick="showDevelopmentNotification()">Enroll This Course</a>
        </div>     

        <div class="box">
            <div class="sub-course">
                <img src="/images/user.png" alt="">
                <div class="info">
                    <h3>Hamkah</h3>
                    <span>Computing Lecturer</span>
                </div>
            </div>
            <div class="thumb">
                <img src="/images/computational thinking.png" alt="">
                <span>18 modules</span>
            </div>
            <h3 class="title">KU1234 Computing</h3>
            <a href="#" class="inline-btn" onclick="showDevelopmentNotification()">view Course</a>
            <a href="#" class="inline-enroll-btn" onclick="showDevelopmentNotification()">Enroll This Course</a>
        </div>     

        <div class="box">
            <div class="sub-course">
                <img src="/images/user.png" alt="">
                <div class="info">
                    <h3>Rahayu</h3>
                    <span>Indonesian Lecturer</span>
                </div>
            </div>
            <div class="thumb">
                <img src="/images/indonesian.png" alt="">
                <span>9 modules</span>
            </div>
            <h3 class="title">KU1235 Indonesian</h3>
            <a href="#" class="inline-btn" onclick="showDevelopmentNotification()">view Course</a>
            <a href="#" class="inline-enroll-btn" onclick="showDevelopmentNotification()">Enroll This Course</a>
        </div>

        <div class="box">
            <div class="sub-course">
                <img src="/images/user.png" alt="">
                <div class="info">
                    <h3>Agus</h3>
                    <span>Sport Lecturer</span>
                </div>
            </div>
            <div class="thumb">
                <img src="/images/sport.png" alt="">
                <span>11 modules</span>
            </div>
            <h3 class="title">KU1236 Sport</h3>
            <a href="#" class="inline-btn" onclick="showDevelopmentNotification()">view Course</a>
            <a href="#" class="inline-enroll-btn" onclick="showDevelopmentNotification()">Enroll This Course</a>
        </div>

        <div class="box">
            <div class="sub-course">
                <img src="/images/user.png" alt="">
                <div class="info">
                    <h3>Dewi</h3>
                    <span>Artificial Intelligence Lecturer</span>
                </div>
            </div>
            <div class="thumb">
                <img src="/images/AI.png" alt="">
                <span>6 modules</span>
            </div>
            <h3 class="title">KU1237 Artificial Intelligence</h3>
            <a href="#" class="inline-btn" onclick="showDevelopmentNotification()">view Course</a>
            <a href="#" class="inline-enroll-btn" onclick="showDevelopmentNotification()">Enroll This Course</a>
        </div>

        <div class="box">
            <div class="sub-course">
                <img src="/images/user.png" alt="">
                <div class="info">
                    <h3>Aptanta</h3>
                    <span>Biology Lecturer</span>
                </div>
            </div>
            <div class="thumb">
                <img src="/images/biology.png" alt="">
                <span>9 modules</span>
            </div>
            <h3 class="title">KU1238 Biology</h3>
            <a href="#" class="inline-btn" onclick="showDevelopmentNotification()">view Course</a>
            <a href="#" class="inline-enroll-btn" onclick="showDevelopmentNotification()">Enroll This Course</a>
        </div>

        <div class="box">
            <div class="sub-course">
                <img src="/images/user.png" alt="">
                <div class="info">
                    <h3>Fazat</h3>
                    <span>Basic Programming Lecturer</span>
                </div>
            </div>
            <div class="thumb">
                <img src="/images/basic-programming.png" alt="">
                <span>10 modules</span>
            </div>
            <h3 class="title">KU1239 Basic Programming</h3>
            <a href="#" class="inline-btn" onclick="showDevelopmentNotification()">view Course</a>
            <a href="#" class="inline-enroll-btn" onclick="showDevelopmentNotification()">Enroll This Course</a>
        </div>
    </div>
</section>

<!-- Custom JS File -->
<script src="/js/script.js"></script>

<script>
    // Load user profile
    async function loadUserProfile() {
        try {
            const response = await fetch("/api/users/profile", { credentials: "include" });
            if (response.ok) {
                const user = await response.json();

                // Update the user name and profile image in various locations
                document.getElementById("headerUserName").textContent = user.name;
                document.getElementById("headerProfileImage").src = user.profileImage || "/images/pic-1.png"; // Default image if no profile image is provided

                document.getElementById("sidebarUserName").textContent = user.name;
                document.getElementById("sidebarUserRole").textContent = user.role || "Student"; // Update user role if available
                document.getElementById("sidebarProfileImage").src = user.profileImage || "/images/pic-1.png";
            } else {
                console.error("Failed to load user profile:", response.status);
            }
        } catch (error) {
            console.error("Error loading user profile:", error);
        }
    }

    // Function to display development notification
    function showDevelopmentNotification() {
        alert("This course is currently under development.");
    }

    function searchCourses(event) {
        event.preventDefault(); // Prevent form submission

        const query = document.getElementById('searchBox').value.trim().toLowerCase();
        const courses = document.querySelectorAll('.courses .box-container .box'); // Select all course boxes

        if (!query) {
            // If the search box is cleared and user submits, show all courses
            courses.forEach(course => {
                course.style.display = ''; // Reset display to show all courses
            });
            return; // Exit the function early
        }

        // Filter courses based on the search query
        courses.forEach(course => {
            const title = course.querySelector('.title').textContent.toLowerCase();
            const lecturer = course.querySelector('.info h3').textContent.toLowerCase();

            // Show or hide the course based on the query match
            if (title.includes(query) || lecturer.includes(query)) {
                course.style.display = ''; // Show the course
            } else {
                course.style.display = 'none'; // Hide the course
            }
        });
    }

    window.addEventListener("DOMContentLoaded", loadUserProfile);
</script>

</body>
</html>
